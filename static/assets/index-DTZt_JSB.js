(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))v(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&v(c)}).observe(document,{childList:!0,subtree:!0});function L(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function v(r){if(r.ep)return;r.ep=!0;const n=L(r);fetch(r.href,n)}})();let C=null,u=[],d=null;async function M(){const p=document.getElementById("app");if(!p)return;p.innerHTML="Loading SQL Server schema...";let y;try{const o=await fetch("/api/db/sqlserver/schema");if(!o.ok)throw new Error(o.statusText);y=await o.json()}catch(o){p.innerHTML=`<pre style="color:red">API error: ${o.message}</pre>`;return}const{tables:L=[],relations:v=[]}=y;p.innerHTML="";const r=document.createElement("canvas");r.width=p.clientWidth,r.height=window.innerHeight,p.appendChild(r);const n=r.getContext("2d");let c=1,b=0,g=0,w=!1,S=0,Y=0,m=null,E=0,O=0;u=L.map((o,e)=>({...o,x:typeof o.x=="number"?o.x:100+e%4*300,y:typeof o.y=="number"?o.y:80+Math.floor(e/4)*200,width:typeof o.w=="number"?o.w:240,height:typeof o.h=="number"?o.h:40+(o.columns?.length||0)*20}));function q(){const o=u.map(e=>({table_name:e.table,x:e.x,y:e.y,w:e.width,h:e.height,hidden:e.hidden||!1,note:e.note||""}));fetch("/api/db/sqlserver/schema/save_location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).catch(e=>{console.error("save_location failed",e)})}function H(){const o=document.createElement("div");o.style.position="fixed",o.style.top="12px",o.style.left="12px",o.style.zIndex="10",o.style.background="#fff",o.style.padding="6px 10px",o.style.borderRadius="6px",o.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",o.style.fontFamily="monospace",o.style.fontSize="14px";const e=document.createElement("input");e.type="text",e.placeholder="Search table...",e.style.width="200px",e.style.padding="4px 6px",e.style.border="1px solid #ccc",e.style.borderRadius="4px",o.appendChild(e),document.body.appendChild(o),e.addEventListener("keydown",t=>{if(t.key==="Enter"){const l=e.value.trim().toLowerCase();if(!l)return;const i=u.find(T=>T.table.toLowerCase().includes(l));if(!i){alert("No match found");return}const s=i.x+i.width/2,a=i.y+i.height/2,f=r.width,x=r.height;b=f/2-s*c,g=x/2-a*c,h()}})}function h(){n.clearRect(0,0,r.width,r.height),n.save(),n.translate(b,g),n.scale(c,c),n.font="12px monospace";for(let e=0;e<u.length;e++){const t=u[e];if(typeof t.x!="number"&&(t.x=100+e%4*300),typeof t.y!="number"&&(t.y=80+Math.floor(e/4)*200),typeof t.width!="number"&&(t.width=240),typeof t.height!="number"){const i=t.columns?.length||0;t.height=40+i*20}const l=8;n.shadowColor="rgba(0, 0, 0, 0.15)",n.shadowBlur=4,n.shadowOffsetX=2,n.shadowOffsetY=2,n.fillStyle="#ffffff",P(n,t.x,t.y,t.width,t.height,l),n.fill(),n.shadowColor="transparent",n.fillStyle="#0066cc",P(n,t.x,t.y,t.width,28,{tl:l,tr:l,br:0,bl:0}),n.fill(),n.fillStyle="#ffffff",n.font="bold 13px monospace",n.fillText(`${t.schema}.${t.table}`,t.x+12,t.y+18),n.fillStyle="#f9f9f9",n.fillRect(t.x,t.y+28,t.width,t.height-28),n.font="12px monospace",t.columns?.forEach((i,s)=>{const a=t.y+44+s*20;d&&d.table===t.table&&d.column===i.name?(n.fillStyle="#fff3e0",n.fillRect(t.x+4,a-14,t.width-8,18),n.fillStyle="#d84315",n.font="bold 12px monospace"):(n.fillStyle="#333",n.font="12px monospace"),n.fillText(`${i.name}: ${i.type}${i.isNullable?"?":""}`,t.x+12,a)})}function o(e,t){const l=e.columns.findIndex(i=>i.name===t);return l===-1?e.y+20:e.y+44+l*20}for(const e of v){const t=u.find(X=>X.table===e.fromTable),l=u.find(X=>X.table===e.toTable);if(!t||!l)continue;const i=o(t,e.fromColumn),s=o(l,e.toColumn),a=d&&(e.fromTable===d.table&&e.fromColumn===d.column||e.toTable===d.table&&e.toColumn===d.column),f=t.x+(t.x<l.x?t.width:0),x=l.x+(t.x<l.x?0:l.width),T=f+(x-f)*.5;n.strokeStyle=a?"#ff4081":"rgba(180, 180, 180, 0.7)",n.lineWidth=a?2.5:1,n.beginPath(),n.moveTo(f,i),n.bezierCurveTo(T,i,T,s,x,s),n.stroke()}n.restore()}function P(o,e,t,l,i,s){typeof s=="number"&&(s={tl:s,tr:s,br:s,bl:s}),o.beginPath(),o.moveTo(e+s.tl,t),o.lineTo(e+l-s.tr,t),o.quadraticCurveTo(e+l,t,e+l,t+s.tr),o.lineTo(e+l,t+i-s.br),o.quadraticCurveTo(e+l,t+i,e+l-s.br,t+i),o.lineTo(e+s.bl,t+i),o.quadraticCurveTo(e,t+i,e,t+i-s.bl),o.lineTo(e,t+s.tl),o.quadraticCurveTo(e,t,e+s.tl,t),o.closePath()}h(),r.addEventListener("mousedown",o=>{const[e,t]=_(o.offsetX,o.offsetY);for(const l of u){const i=l.y+40;for(let s=0;s<(l.columns?.length||0);s++){const a=i+s*20;if(e>=l.x&&e<=l.x+l.width&&t>=a-10&&t<=a+10){d={table:l.table,column:l.columns[s].name},h();return}}}for(const l of u.slice().reverse())if(e>=l.x&&e<=l.x+l.width&&t>=l.y&&t<=l.y+l.height){m=l,E=e-l.x,O=t-l.y;return}d=null,w=!0,S=o.clientX,Y=o.clientY,h()}),r.addEventListener("mousemove",o=>{const[e,t]=_(o.offsetX,o.offsetY);m?(m.x=e-E,m.y=t-O,h()):w&&(b+=o.clientX-S,g+=o.clientY-Y,S=o.clientX,Y=o.clientY,h())}),r.addEventListener("mouseup",()=>{m&&(clearTimeout(C),C=setTimeout(q,300)),m=null,w=!1}),r.addEventListener("mouseleave",()=>{m&&(clearTimeout(C),C=setTimeout(q,300)),m=null,w=!1}),r.addEventListener("wheel",o=>{o.preventDefault();const e=1.1,t=o.offsetX,l=o.offsetY,i=(t-b)/c,s=(l-g)/c,a=o.deltaY<0?e:1/e,f=c*a;b=t-i*f,g=l-s*f,c=f,h()});function _(o,e){return[(o-b)/c,(e-g)/c]}H()}document.querySelector("#app").innerHTML=`
  <div>
 
    <h1>Hello Vite!</h1>
    <div class="card">
      <button id="counter" type="button"></button>
    </div>
    <p class="read-the-docs">
      Click on the Vite logo to learn more
    </p>
  </div>
`;M();
